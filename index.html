<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reader</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="main.js"></script>
    <script type="text/javascript" src="book.js"></script>
</head>
<body>
<div class="main-wrapper">
    <div class="buttons">
        <button id="prev-page"><--</button>
        <div class="pages-amount"></div>
        <button id="next-page">--></button>
    </div>
    <div class="text-wrapper">
        <div class="text"></div>
    </div>
</div>
<footer>
    <script type="text/javascript">
      console.time('x');
      const sections = bookDoc.firstElementChild.children;
      // const titles = [...sections].map(section => section.querySelector('title').innerHTML);
      const sec = sections[0];
      replaceTitles(sec);
      replaceEmptyLines(sec);
      const textHolder = document.querySelector('.text');
      const { width, height } = textHolder.getBoundingClientRect();
      const INDENT_SIZE = 20;
      const LINE_HEIGHT = 18;


      const SIZES = calcSizes();

      const abz = [...sec.querySelectorAll('p')].map(a => a.innerHTML);
      // const m = abz.map(txt => ({ txt, lines: calcAbzLines(txt, width) }));
      const pages = splitTextToPages(abz, { width, height, lineHeight: LINE_HEIGHT, interval: 3 });
      console.timeEnd('x');
      console.log(pages);
      let currentPage = 0;
      const maxPage = pages.length - 1;
      const prev = document.getElementById('prev-page');
      const next = document.getElementById('next-page');
      const pagesAmount = document.querySelector('.pages-amount');
      const goToPage = (page) => {
        renderPage(pages[page], textHolder);
        prev.disabled = page === 0;
        next.disabled = page === maxPage;
        pagesAmount.innerText = `${currentPage + 1} / ${ maxPage + 1}`;
      };
      prev.onclick = () => {
        currentPage > 0 && goToPage(--currentPage);
      };
      next.onclick = () => {
        currentPage < maxPage && goToPage(++currentPage);
      };
      goToPage(currentPage);
      // textHolder.innerHTML = sec.innerHTML;
    </script>
</footer>
</body>
</html>
